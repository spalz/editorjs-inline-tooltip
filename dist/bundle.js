!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.EditorjsInlineTooltip=t():e.EditorjsInlineTooltip=t()}(window,(function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=0)}([function(e,t,n){"use strict";n.r(t),n.d(t,"LinkInlineTool",(function(){return s}));class i{constructor(){this.instance=null,this.selection=null,this.savedSelectionRange=null,this.isFakeBackgroundEnabled=!1,this.commandBackground="backColor",this.commandRemoveFormat="removeFormat"}static get range(){const e=window.getSelection();return e&&e.rangeCount?e.getRangeAt(0):null}static get text(){return window.getSelection?window.getSelection().toString():""}static get(){return window.getSelection()}removeFakeBackground(){this.isFakeBackgroundEnabled&&(this.isFakeBackgroundEnabled=!1,document.execCommand(this.commandRemoveFormat))}setFakeBackground(){document.execCommand(this.commandBackground,!1,"#ff0000"),this.isFakeBackgroundEnabled=!0}save(){this.savedSelectionRange=i.range}restore(){if(!this.savedSelectionRange)return;const e=window.getSelection();e.removeAllRanges(),e.addRange(this.savedSelectionRange)}clearSaved(){this.savedSelectionRange=null}collapseToEnd(){const e=window.getSelection(),t=document.createRange();t.selectNodeContents(e.focusNode),t.collapse(!1),e.removeAllRanges(),e.addRange(t)}}const o=[{type:"input",name:"input",label:"URL",props:{placeholder:"URL"}},{type:"input",name:"title",label:"Title",props:{placeholder:"Title"}},{type:"input",name:"target",label:"Target",description:"Open in new Window",props:{type:"checkbox"}}];class s{constructor({api:e}){this.commandLink="insertHTML",this.commandUnlink="unlink",this.ENTER_KEY=13,this.CSS=null,this.nodes={actionContainer:null,button:null,buttonSubmit:null,input:null,inputContainer:null,title:null,titleContainer:null,target:null,targetContainer:null},this.inputOpened=!1,this.toolbar=e.toolbar,this.inlineToolbar=e.inlineToolbar,this.notifier=e.notifier,this.apiSelection=e.selection,this.selection=new i,this.CSS={button:e.styles.inlineToolButton,buttonActive:e.styles.inlineToolButtonActive,input:"ce-inline-tool-input",inputShowed:"ce-inline-tool-input--showed"},(()=>{const e="inline-tool-styling";if(!document.getElementById(e)){const t=document.createElement("style");t.id=e,t.innerHTML="\n        .ce-inline-link-tool.ce-inline-tool-input--showed {\n          padding: 0;\n        }\n        .ce-inline-tool-container {\n          border-top: 1px solid rgba(201,201,204,.48);\n          padding: 5px;\n          padding-left: 10px;\n        }\n        .ce-inline-tool-container label span:first-child  {\n          padding-right: 10px;\n          width: 30px;\n          display: inline-block;\n        }\n        .ce-inline-tool-container input {\n          outline: none;\n          border: 0;\n          border-radius: 0 0 4px 4px;\n          margin: 0;\n          font-size: 13px;\n          margin: 5px;\n          -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n          font-weight: 500;\n        }\n        .ce-inline-tool-container input + span {\n          padding-left: 5px;\n        }\n        .ce-inline-link-tool button {\n          outline: none;\n          padding: 5px 10px;\n          background: transparent;\n          margin-left: 10px;\n          display: block;\n          margin-bottom: 10px;\n          box-sizing: border-box;\n        }\n    ",document.head.appendChild(t)}})()}get shortcut(){return"CMD+K"}static get sanitize(){return{a:{href:!0,rel:"nofollow",target:"_blank",title:!0}}}render(){return this.nodes.button=document.createElement("button"),this.nodes.button.type="button",this.nodes.button.classList.add(this.CSS.button),this.nodes.button.innerHTML='<svg class="icon icon--link" width="14px" height="10px"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#link"></use></svg>',this.nodes.button}renderActions(){return this.nodes.actionContainer=document.createElement("div"),this.nodes.actionContainer.classList.add("ce-inline-link-tool"),this.nodes.actionContainer.classList.add(this.CSS.input),this.nodes.buttonSubmit=document.createElement("button"),this.nodes.buttonSubmit.innerText="OK",this.nodes.buttonSubmit.onclick=this.dataEntered.bind(this),o.forEach(e=>{const t=e.name+"Container";this.nodes[t]=document.createElement("div"),this.nodes[t].classList.add("ce-inline-tool-container");const n=document.createElement("label");if(n.innerHTML=`<span>${e.label}</span>`,this.nodes[e.name]=document.createElement(e.type),Object.keys(e.props).forEach(t=>{this.nodes[e.name][t]=e.props[t],"checkbox"===e.props.type&&(this.nodes[e.name].checked=!0)}),this.nodes[e.name].addEventListener("keydown",e=>{e.keyCode===this.ENTER_KEY&&e.preventDefault()}),n.appendChild(this.nodes[e.name]),e.description){const t=document.createElement("span");t.innerText=e.description,n.appendChild(t)}this.nodes[t].appendChild(n),this.nodes.actionContainer.appendChild(this.nodes[t])}),this.nodes.actionContainer.appendChild(this.nodes.buttonSubmit),this.nodes.actionContainer}surround(e){if(e){this.inputOpened?(this.selection.restore(),this.selection.removeFakeBackground()):(this.selection.setFakeBackground(),this.selection.save());const e=this.apiSelection.findParentTag("A");if(e)return this.apiSelection.expandToTag(e),this.unlink(),this.closeActions(),this.checkState(),void this.toolbar.close()}this.toggleActions()}checkState(){const e=this.apiSelection.findParentTag("A");if(e){this.nodes.button.classList.add(this.CSS.buttonActive),this.openActions();const t=e.getAttribute("href"),n=e.getAttribute("title"),i=e.getAttribute("target");this.nodes.input.value=t||"",this.nodes.title.value=n||"",this.nodes.target.checked="_blank"===i,this.selection.save()}else this.nodes.button.classList.remove(this.CSS.buttonActive);return!!e}clear(){this.closeActions()}toggleActions(){this.inputOpened?this.closeActions(!1):this.openActions(!0)}openActions(e=!1){this.nodes.actionContainer.classList.add(this.CSS.inputShowed),e&&this.nodes.input.focus(),this.inputOpened=!0}closeActions(e=!0){if(this.selection.isFakeBackgroundEnabled){const e=new i;e.save(),this.selection.restore(),this.selection.removeFakeBackground(),e.restore()}this.nodes.actionContainer.classList.remove(this.CSS.inputShowed),this.nodes.input.value="",this.nodes.title.value="",this.nodes.target.checked=!0,e&&this.selection.clearSaved(),this.inputOpened=!1}dataEntered(e){let t=this.nodes.input.value||"";t.trim()||(this.selection.restore(),this.unlink(),e.preventDefault(),this.closeActions()),this.validateURL(t)?(t=this.prepareLink(t),this.selection.restore(),this.selection.removeFakeBackground(),this.insertLink(t),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),this.selection.collapseToEnd(),this.inlineToolbar.close()):this.notifier.show({message:"Pasted link is not valid.",style:"error"})}validateURL(e){return!/\s/.test(e)}prepareLink(e){let t=e;return t=t.trim(),t=this.addProtocol(t),t}addProtocol(e){let t=e;if(/^(\w+):(\/\/)?/.test(t))return t;const n=/^\/[^/\s]/.test(t),i="#"===t.substring(0,1),o=/^\/\/[^/\s]/.test(t);return n||i||o||(t="http://"+t),t}insertLink(e){const t=this.apiSelection.findParentTag("A");t&&this.apiSelection.expandToTag(t);const n=this.nodes.target.checked?'target="_blank"':"",o=""!==this.nodes.title.value?`title="${this.nodes.title.value}"`:"";document.execCommand(this.commandLink,!1,`<a href="${e}" ${n} ${o}>${i.text}</a>`)}unlink(){document.execCommand(this.commandUnlink)}}s.isInline=!0,s.title="Link"}])}));
//# sourceMappingURL=bundle.js.map